{{/* This template renders a single recipe! */}}
<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
  <head>
    {{ partial "preamble.html" . }}
    <title>{{ .Title }} | {{ .Site.Title }}</title>
    <meta property="og:title" content="{{ .Title }}" />
    <meta property="og:description" content="Difficulty: {{ .Page.Params.difficulties }} • Meal: {{ .Page.Params.meals }} • {{ .Summary }}" />
    <meta property="og:url" content="https://github.com/{{ .Site.Params.cookbookRepo }}" />
    <meta property="og:site_name" content="CompSoc Cookbook" />
    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z0700" }}" />
    <meta property="og:article:section" content="Recipes" />
    {{- $tags := .Page.Params.tags -}}
    {{/* Tags are a supposed to be arrays but just incase someone puts a string:*/}}
    {{- with $tags -}}
    {{- if not (reflect.IsSlice $tags) -}}
      {{- $tags = slice $tags -}}
    {{- end -}}}
    {{- end -}}
    {{ range $val := $tags }}
    <meta property="og:article:tag" content="{{ $val }}" />
    {{- end }}
  </head>
  <body>
    <div class="container">
      {{ partial "navbar.html" . }}
      <main>
        <article class="recipe">
          <!-- Header -->
          <div class="d-flex flex-column align-items-center mb-5">
            <div class="recipe-keywords">
              <time class="recipe-keyword mx-2" datetime="{{ .Date }}">{{ .Date.Format "2 Jan, 2006" }}</time>
              •
              <b><a class="recipe-keyword mx-2" href="{{ printf "/difficulties/%s" (.Page.Params.difficulties | urlize) | relURL }}">
                {{ .Page.Params.difficulties }}
              </a></b>
              •
              <b><a class="recipe-keyword mx-2" href="{{ printf "/meals/%s" (.Page.Params.meals | urlize) | relURL }}">
                {{ .Page.Params.meals }}
              </a></b>
            </div>
            <h1 class="display-2 mb-4 text-center">{{ .Title }}</h1>
            <div class="recipe-properties d-flex">
              {{ with .Page.Params.allergens }}
              <div class="recipe-property text-center mx-3">
                Contains<br>
                <b>{{ range $key := . }}{{ $key }}{{ end }}</b>
              </div>
              {{ end }}
              {{ range $key, $val := .Page.Params }}
              {{/* Display all custom params, excluding Hugo defaults and ones already shown */}}
              {{ $ignored := (slice "tags" "allergens" "meals" "difficulties" "iscjklanguage" "draft" "layout" "title" "date" "publishdate" "lastmod")}}
              {{ if not (in $ignored $key) }}
              <div class="recipe-property text-center mx-3">
                {{ $key | title }}<br>
                <b>{{ $val }}</b>
              </div>
              {{ end }}
              {{ end }}
            </div>
          </div>
          <section class="recipe-body row justify-content-center">
            <div class="col-12 col-md-10">
              {{ .Content | emojify | safeHTML }}

              <div class="recipe-keywords mt-5">
                {{ range $val := $tags -}}
                  <a class="recipe-keyword mx-2" href="{{ printf "/tags/%s" ($val | urlize) | relURL }}">#{{ $val }}</a>
                {{- end }}
              </div>
            </div>
          </section>
        </article>
        {{ partial "comments.html" . }}
      </main>
      {{ partial "footer.html" . }}
    </div>
    {{ partial "postamble.html" }}
  </body>
</html>
