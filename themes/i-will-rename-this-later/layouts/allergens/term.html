<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
  <head>
    {{ partial "preamble.html" }}
    <title>Browsing all dishes that are {{ .Title }}</title>
  </head>
  <body>
    <div class="container">
      {{ partial "navbar.html" . }}
      <main>
        <h1 class="display-2 text-center">{{ .Title | title }}</h1>
        <h4 class="text-center">List of recipes that do <b>not</b> contain {{ .Title }}.</h4>
        <span class="d-block text-center mb-5">We can unfortunately not make any guarantees, as the labeling is up to the contributor of each recipe.</span>
        {{/* Since Hugo does not have a set complement function to be used in */}}
        {{/* "where", we manually construct a list of all pages, loop, and exclude. */}}
        {{ $allPages := ((where $.Site.RegularPages "Type" "recipes").ByTitle.Reverse).ByPublishDate.Reverse }}
        {{ $remainingPages := slice }}
        {{ range $page := $allPages }}
          {{ if not (or (in $page.Params.allergens $.Title) (isset $page.Params "allergens")) }}
            {{ $remainingPages = $remainingPages | append $page }}
          {{ end }}
        {{ end }}
        {{ partial "listing.html" (dict "amount" 12 "pages" $remainingPages "page" .) }}
      </main>
      {{ partial "footer.html" . }}
    </div>
    {{ partial "postamble.html" }}
  </body>
</html>
